---
title: "DRI_analysis"
author: "pjrice"
date: "January 26, 2017"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

############################################################################################################################################################################
############################################################################################################################################################################
############################################################################################################################################################################
############################################################################################################################################################################
############################################################################################################################################################################

Keep all the junk above for right now to reference while writing document

First, we should probably set the working directory and load the data, right?

```{r load da data}
#set wd to data dir
setwd('/media/storage/testing_ground/R/RR_TMS_data')

#read data file
data = read.table('table4R.txt', header=T, sep=",")
```

We did it reddit!!!!

Now convert some of the values to make the table slightly more readable...

```{r clarify}

#Convert some values to make it more readable
data$infIns[data$infIns == 0] = "Inferred"
data$infIns[data$infIns == 1] = "Instructed"

data$SF[data$SF == 0] = "Symbol"
data$SF[data$SF == 1] = "Finger"

data$PV[data$PV == 0] = "PMd" 
data$PV[data$PV == 1] = "Vertex"

data$ELN[data$ELN == 0] = "Early" 
data$ELN[data$ELN == 1] = "Late"
data$ELN[data$ELN == 2] = "noStim"

#convert subject IDs to factor
data$subjID = as.factor(data$subjID)

#add condition index column to data frame
data$condIdx = interaction(data$SF,data$PV,data$ELN,data$infIns)

```

Here's the head of our table:

```{r}

head(data)

```

Wow that's fuck ugly! Let's try again:

```{r kable}

library(knitr)

kable(head(data))

```

Wowee that's an alright looking table!

Let's continue actually working:

There are some NaNs in the dataset:
Subject 2406, block 1 is invalid - coil had drifted off target. All entries from that block have been NaNed, so let's not consider those.
There are also a couple of random NaNs in other subject's rule/stimRT vectors, where they did not respond - let's not consider these either.

While we're at it, let's make a subset of correct trials and a subset of incorrect trials to examine independently.

```{r NaNs}

#remove subj 2406 first block (NaNed out) and other random trials where subj didn't respond
data = subset(data, data$PV!="NaN" & data$ruleRT!="NaN" & data$stimRT!="NaN")

#get subset of only correct trials
correct = subset(data, data$success==1)

#get subset of only error trials
incorrect = subset(data, data$success!=1)

```

Cool. Let's now aggregate some data for success rates, rule RTs, and stim RTs:

```{r aggregate}

#aggregate success rate data
success = aggregate(data[c("success")], list(subjID=data$subjID,
                                             SF=data$SF,
                                             PV=data$PV,
                                             ELN=data$ELN,
                                             infIns=data$infIns),
                    mean)

#aggregate ruleRT data
ruleRT = aggregate(data[c("ruleRT")], list(subjID=data$subjID,
                                             SF=data$SF,
                                             PV=data$PV,
                                             ELN=data$ELN,
                                             infIns=data$infIns),
                    mean)

#aggregate stimRT data
stimRT = aggregate(data[c("stimRT")], list(subjID=data$subjID,
                                             SF=data$SF,
                                             PV=data$PV,
                                             ELN=data$ELN,
                                             infIns=data$infIns),
                    mean)

kable(head(success))
kable(head(ruleRT))
kable(head(stimRT))
```

Alrighty, that's nice. How about we start plotting some data?

```{r scatterplots}

library(ggplot2)

#scatterplots - color by trial cond - successes and errors
  #global ruleRT:stimRT for all conditions
  #per subject ruleRT:stimRT for all conditions
  #same as the two above, for single conditions and joint conditions

#global ruleRT:stimRT
#create the plot, considering only correct trials, with stimRT on xaxis and ruleRT on yaxis
sp1 = ggplot(correct, aes(x=stimRT, y=ruleRT))
#color the points by subjID and print the plot
(sp1+geom_point(aes(color=subjID))
    +labs(title='The relationship between ruleRT and stimRT, correct trials only',x = 'stimRT (s)', y = 'ruleRT (s)')
    +scale_x_continuous(breaks = round(seq(0,round(max(data$stimRT))+1,by = 0.1),1))
    +scale_y_continuous(breaks = round(seq(0,round(max(data$ruleRT))+1,by = 0.1),1)))

#create the plot, considering only error trials, with stimRT on xaxis and ruleRT on yaxis
sp2 = ggplot(incorrect, aes(x=stimRT, y=ruleRT))
#color the points by subjID and print the plot
(sp2+geom_point(aes(color=subjID))
  +labs(title='The relationship between ruleRT and stimRT, incorrect trials only',x = 'stimRT (s)', y = 'ruleRT (s)')
  +scale_x_continuous(breaks = round(seq(0,round(max(data$stimRT))+1,by = 0.1),1))
  +scale_y_continuous(breaks = round(seq(0,round(max(data$ruleRT))+1,by = 0.1),1)))

#per subject ruleRT:stimRT, correct trials - color by trial condition
#currently plots all subjects
sp3 = ggplot(correct, aes(x=stimRT, y=ruleRT))
(sp3+geom_point(aes(color=condIdx))
  +labs(title='The relationship between ruleRT and stimRT, correct trials only',x = 'stimRT (s)', y = 'ruleRT (s)')
  +scale_x_continuous(breaks = round(seq(0,round(max(data$stimRT))+1,by = 0.1),1))
  +scale_y_continuous(breaks = round(seq(0,round(max(data$ruleRT))+1,by = 0.1),1))
  +theme(legend.position='bottom'))

```

























